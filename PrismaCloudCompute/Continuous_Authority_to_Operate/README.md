# Continuous Authority to Operate

This repository contains scripts to implement the Continuous Authority to Operate framework.

## Scripts:
**CATO-collection_query.ps1** - This script is used for the "Continuous Authority to Operate" (C-ATO) concepts to identify all vulnerabilities associated with a [Collection](https://docs.paloaltonetworks.com/prisma/prisma-cloud/20-04/prisma-cloud-compute-edition-admin/configure/collections.html) of images. The output is a CSV file containing all the unique CVE/packages found in all the images within a collection. An ATO Auditor can make the determination of what [Tag](https://docs.paloaltonetworks.com/prisma/prisma-cloud/20-04/prisma-cloud-compute-edition-admin/configure/tags.html) they want to associate with each CVE. The CVS file is then used as input for the CATO-tag_population.ps1 script to associate CVEs to Tags within the Console.

  * Logic:
    1. Generates a list of all the images within a Collection supplied as a command line argument.
    2. Queries for unique images in Deployed Images, Registry and CI. Images found in multiple locations are counted once.
    3. Calls "Unique_CVE" function to identify all the CVE/packages found in all the unique images.
    4. Generates a CSV output file for the ATO Auditor to review and associate Tags.


  * Modify:
    * Change the _$tlconsole_ variable for your Prisma Cloud Compute's API URL


  * Input:
    * Name of the Prisma Cloud Compute Collection for the ATO boundary. For example, "ATO-20200601-1" is a Collection of images that have the Label "ATO-20200601-1." You will be prompted for username/password
    ```
    ./CATO-collection_query.ps1 ATO-20200601-1
    ```


  * Output:
    * The number of unique images, number of unique CVE/packages and the name for the output CSV.
    ```
    Checking for images within collection: ATO-20200601-1
    PowerShell credential request
    Enter your credentials.
    User: pfox
    Password for user pfox: *********
    Unique Images:  9
    Unique CVE/packages found:  505
    Output CSV: 20200625-121538-ATO-20200601-1-cves.csv
    ```



**CATO-tag_population.ps1** - This script uses the output CSV generated but the _CATO-collection_query.ps1_ script as input. An ATO Auditor makes the determination of what Tag they want to associate with each CVE. The CSV file is then used as input for this script to associate CVEs to Tags within the Console.

  * Prerequisites:
    1. Create Tags within the Console that the vulnerabilities will be associated to.
    2. Update the "Tag" column for every vulnerability with the Tag name in the CSV generated by the _CATO-collection_query.ps1_ script


  * Logic:
    1. Reads in the CSV supplied as command lime argument.
    2. Associates CVEs to Tags.


  * Modify:
    * Change the _$tlconsole_ variable for your Prisma Cloud Compute's API URL

  * Input:
      * Name of CSV generated by the _CATO-collection_query.ps1_ which has been updated by an Auditor to associate vulnerabilities with Tags.
      ```
      ./CATO-tag_population.ps1 20200625-121538-ATO-20200601-1-cves.csv
      ```

  * Output:
    * The number of CVEs associated to Tags.
    ```
    Importing 20200625-121538-ATO-20200601-1-cves.csv
    PowerShell credential request
    Enter your credentials.
    User: pfox
    Password for user pfox: *********
    Associated 505 CVEs to Tags
    ```

## Prerequisite:
[Powershell v6+](https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7)

Feel free to port to your language of choice.
